<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="res/jquery.min.js"></script>
    <title>Content</title>
</head>
<body>
<script>
opened = localStorage.getItem("opened");
fileLoaded = false;
let myScript = document.createElement("script");
myScript.setAttribute("src", "res/var/"+opened+".js");
document.body.appendChild(myScript);
</script>
<style>
@font-face {
    font-family: feather;
    src: url(res/font/feather_bold.otf);
}

html, body {
width: 100%; height: 100vh; overflow: hidden;
}
body {
background-color: #cdccd0;
color: black; margin: 0;
font-family: feather;
user-select: none; /* supported by Chrome and Opera */
-webkit-user-select: none; /* Safari */
-khtml-user-select: none; /* Konqueror HTML */
-moz-user-select: none; /* Firefox */
-ms-user-select: none; /* Internet Explorer/Edge */
}

.fixed_bg {
width: 100vw; height: 70vh;
background-color: black;
position: fixed; top: 0; left: 0;
border-radius: 0 0 20px 20px;
z-index: -1;
animation: fixed_bg 400ms ease 1;
transition: all 400ms ease;
} @keyframes fixed_bg {
    0% {transform: translateY(-100%); opacity: 0;}
    100% {transform: translateY(0%); opacity: 1;}
}

.top {
width: 100vw; height: 20vh;
animation: top 400ms ease 1;
transition: all 400ms ease;
} @keyframes top {
    0% {transform: scale(1.2); opacity: 0;}
    100% {transform: scale(1); opacity: 1;}
}
.back-img {
position: fixed; top: 5vh; left: 5vw;
width: 6vh; height: 6vh;
} .back-img:active {
opacity: .5;
}
.title-bg {
width: 100vw; text-align: center;
font-size: 9vw; color: white;
padding-top: 4vh;
display: flex; flex-wrap: wrap;
align-content: center;
}
.title {
width: 100vw;
}
.ques {
width: 100vw;
font-size: 4vw;
}
.levels {
color: white; font-size: 7vw;
position: absolute; top: 6vh; left: 88vw;
}

.btm {
width: 100vw; height: 79vh;
display: flex; flex-wrap: wrap; justify-content: space-around;
align-items: center;
animation: btm 400ms ease 1;
transition: all 400ms ease;
} @keyframes btm {
    0% {transform: translateY(100%); opacity: 0;}
    100% {transform: translateY(0%); opacity: 1;}
}
.btm-ct {
width: 90vw; height: 100%;
border-radius: 15px; background-color: white;
display: flex; flex-wrap: wrap;
justify-content: center; align-content: baseline;
}

.question {
width: 100%; height: 15vh;
} .question-ct {
padding: 1vh 3vw;
font-size: 4vw;
}

.add-comment-bg {
width: 95%; height: 7vh;
border-radius: 5px;
display: flex; justify-content: space-around; align-items: center;
}

.input {
width: 75%; height: 4.5vh;
padding: 0 3vw;
font-family: feather;
background-color: transparent;
border-radius: 10px;
border: solid 1vw black;
color: white;
}
.share-img {
width: 4vh; height: 4vh;
} .share-img:active {
transition: none; opacity: .6;
}

.sort-bg {
width: 100%; height: 5vh;
display: none; justify-content: flex-end;
}
.sort-ct {
margin-right: 5vw; visibility: hidden;
display: flex; flex-wrap: wrap;
justify-content: center; align-content: center;
}
.sort-txt {
font-size: 4vw;
}
.down-img {
width: 2vh; height: 2vh;
margin-left: 1vw;
transform: translateY(.5vh);
}

.comment-ct {
width: 90%; height: 48vh;
border-radius: 15px;
overflow-y: scroll;
border: solid .7vw black;
position: relative;
} .comment-area {width: 100%; height: 100%;}
.show-comment {
width: 100%; padding: 2vh 0;
background-color: black; color: white;
border-radius: 10px; font-size: 4vw;
position: absolute; top:37vh; left:0;
text-align: center;
} .show-comment:active {
transition: none; opacity: .5;
}

.nav-bg {
width: 100%; height: 9vh;
display: flex; flex-wrap: wrap;
justify-content: space-around; align-content: center;
}
.nav-img {
width: 6vh; height: 6vh;
} .nav-img:active {
transition: none; opacity: .5;
}
</style>

<div class="fixed_bg"></div>
<div class="top">
<img src="res/img/back.webp" class="back-img">
<div class="title-bg">
    <div class="title">What If</div><div class="ques">Questions</div>
</div>
<div class="levels">23</div>
</div>

<div class="btm">
<div class="btm-ct">

<div class="question">
    <div class="question-ct"></div>
</div>

<div class="add-comment-bg">
<input type="text" class="input" id="input" placeholder="Write your comment here">
<img src="res/img/share.webp" class="share-img submit">
</div>

<div class="sort-bg">
<div class="sort-ct">
    <div class="sort-txt">Sort</div>
    <img src="res/img/down.webp" class="down-img">
</div>
</div>

<style>
.com-ct {
display: flex; flex-wrap: wrap;
justify-content: center;
}
.com-top {
width: 100%; height: 5vh; margin-top: 1vh;
display: flex; align-items: center;
}
.profile-img {
margin: 0 2vw;
width: 4vh; height: 4vh;
}
.c-name {
padding-left: 1vw;
}
.com-btm {
width: 100%;
padding: 1vw 2vw;
padding-bottom: 3vw;
}
.com-break {
width: 70%; height: 1.5px; border-radius: 50%; background-color: #6c6c6c;
}

.toast {
width: 76vw; padding: 1vh 4vw;
background-color: black; border-radius: 10px; display: none;
position: fixed; top: 60vh; left: 8vw; color: white;
text-align: center; font-size: 4vw;
animation: toast 400ms ease 1;
transition: all 400ms ease;
} @keyframes toast {
    0% {transform: scale(1.3); opacity: 0;}
    100% {transform: scale(1); opacity: 1;}
}
</style>
<div class="comment-ct">
<div class="comment-area"></div>
<div class="show-comment">Show comments</div>
</div>

<div class="nav-bg">
<img src="res/img/prev.webp" class="nav-img prev">
<img src="res/img/next.webp" class="nav-img next">
</div>

</div>
</div>

<div class="toast">Comment sent</div>

<script>

function appendAll() {
Hypothetical_levels = localStorage.getItem("Hypothetical_levels");
Funny_levels = localStorage.getItem("Funny_levels");
Ironic_levels = localStorage.getItem("Ironic_levels");
Bestfriend_levels = localStorage.getItem("Bestfriend_levels");

levels = window[opened+"_levels"];
$(".levels").html(levels);

$(".question-ct").html(window["c" + levels]);
}
appendAll();
fileIntervel = setInterval(() => {
if (fileLoaded) {
    clearInterval(fileIntervel);
    appendAll();}
}, 400);

function showToast() {
setTimeout(() => {$(".toast").fadeIn(0);}, 100);
setTimeout(() => {$(".toast").css({transform:"scale(1.3)", opacity:'0'});}, 2000);
setTimeout(() => {$(".toast").fadeOut(0); $(".toast").css({transform:"scale(1)", opacity:'1'});}, 2300);
}
</script>

<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.3.1/firebase-database.js"></script>
<script>
  var firebaseConfig = {
    apiKey: "AIzaSyDgTAlhGuPZ0P1s_9mN-efuOLs6iwUkzbQ",
    authDomain: "what-if-cfbf4.firebaseapp.com",
    databaseURL: "https://what-if-cfbf4-default-rtdb.firebaseio.com",
    projectId: "what-if-cfbf4",
    storageBucket: "what-if-cfbf4.appspot.com",
    messagingSenderId: "75261769675",
    appId: "1:75261769675:web:142917cc9d215218ea684e",
    measurementId: "G-TS187NK8L0"
  };

  // Initialize Firebase
firebase.initializeApp(firebaseConfig);

var database = firebase.database();

$(".submit").click(function() {
name = localStorage.getItem("name");
ct = document.getElementById("input").value;

if (ct == "" || ct == null) {
    $(".toast").html("Please write something related to the question");
    showToast();
} else {
    database.ref( opened +'/'+levels).push({
    name: name,
    ct: ct,
  },  function(error){
            if (error) {
            $(".toast").html("Comment failed to sent");
            showToast();
            }
            $(".toast").html("Comment successfully sent");
            showToast();
        });
}
});

function fetchAllData() {
firebase.database().ref(opened +'/'+levels).once('value',function(snapshot) {
    snapshot.forEach(
        function(ChildSnapshot){
            let name_of = ChildSnapshot.val().name;
            let ct_of = ChildSnapshot.val().ct;
            $(".comment-area").append(`
            <div class="com-ct">
            <div class="com-top">
            <img src="res/img/profile.webp" class="profile-img">
            <div class="c-name">${name_of}</div>
            </div>
            <div class="com-btm">${ct_of}</div>
            <div class="com-break"></div>
            </div>
            `);
        }
    );
    console.log("recieved");

});
}

$(".show-comment").click(function() {
fetchAllData();
$(this).fadeOut();
});

function Outro() {
setTimeout(() => {$(".fixed_bg").css({transform:'translateY(-100%)', opacity:'0'});}, 100);
setTimeout(() => {$(".top").css({transform:'scale(1.2)', opacity:'0'});}, 200);
setTimeout(() => {$(".btm").css({transform:'translateY(100%)', opacity:'0'});}, 100);
}

if (levels == 1) {
$(".prev").css({visibility:'hidden'});
}
if (levels == localStorage.getItem(opened + "_all_levels")) {
$(".next").css({visibility:'hidden'});
}

$(".next").click(function() {
levels ++;
if (levels == localStorage.getItem(opened + "_all_levels")) {
$(this).css({visibility:'hidden'});
}
localStorage.setItem(opened + "_levels", levels);
appendAll();
$(".prev").css({visibility:'visible'});
});

$(".prev").click(function() {
levels --;
if (levels == 1) {
$(this).css({visibility:'hidden'});
}
localStorage.setItem(opened + "_levels", levels);
appendAll();
$(".next").css({visibility:'visible'});
});

$(".nav-img").click(function() {
$(".comment-area").empty();
$(".show-comment").fadeIn();
});


$(".back-img").click(function() {
Outro();
setTimeout(() => {window.history.back();}, 600);
});
</script>
</body>
</html>